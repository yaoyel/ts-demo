{"version":3,"file":"AuthController.js","sourceRoot":"","sources":["../../../src/controllers/AuthController.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;;GAEG;AACH,6DAA0G;AAC1G,mCAA+B;AAE/B,oCAAsC;AACtC,yBAAyB;AACzB,6BAA6B;AAI7B,IAAa,cAAc,GAA3B;IAEI,KAAK;QAED,IAAI,IAAI,GAAE,EAAE,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,EAAC,KAAK,EAAC,QAAQ,EAAC,KAAK,EAAC,aAAa,CAAC,CAAC,CAAC;QACnF,IAAI,KAAK,GAAC,GAAG,CAAC,IAAI,CAAC;YACX,IAAI,EAAC,EAAC,MAAM,EAAC,KAAK,EAAC,UAAU,EAAC,QAAQ,EAAC,KAAK,EAAC,MAAM,EAAC;SAAC,EACzD,IAAI,EAAC,EAAC,SAAS,EAAC,OAAO,EAAC,SAAS,EAAC,IAAI,EAAC,CAAC,CAAC;QAC7C,MAAM,CAAC,EAAC,KAAK,EAAC,CAAC;IACnB,CAAC;IAID,QAAQ,CAA8B,IAAQ;QAE1C,MAAM,CAAC,IAAI,CAAC;IAEhB,CAAC;CACJ,CAAA;AAhBG;IADC,yBAAG,CAAC,aAAa,CAAC;;;;2CAQlB;AAID;IAFC,yBAAG,CAAC,gBAAgB,CAAC;IACrB,gCAAU,EAAE;IACH,WAAA,iCAAW,CAAC,EAAC,QAAQ,EAAC,IAAI,EAAC,CAAC,CAAA;;;;8CAIrC;AAjBQ,cAAc;IAF1B,gBAAO,EAAE;IACT,gCAAU,EAAE;GACA,cAAc,CAkB1B;AAlBY,wCAAc","sourcesContent":["/**\n * Created by ybc on 2017/8/23.\n */\nimport {JsonController, Get, Post, Param, Controller, Authorized, CurrentUser} from \"routing-controllers\";\nimport {Service} from \"typedi\";\nimport {UsersRepository} from \"../repository/UserRepository\";\nimport  * as  jwt from \"jsonwebtoken\";\nimport * as fs from \"fs\";\nimport * as path from \"path\";\n\n@Service()\n@Controller()\nexport class AuthController{\n    @Get(\"/auth/token\")\n    login():any\n    {\n        var cert= fs.readFileSync(path.join(__dirname,\"../\",\"config\",\"ssl\",\"private.key\"));\n        var token=jwt.sign({\n                data:{\"name\":\"ybc\",\"nickName\":\"yooyle\",\"org\":\"chrd\"}},\n            cert,{algorithm:\"RS256\",expiresIn:\"1h\"});\n        return {token};\n    }\n\n    @Get(\"/auth/userInfo\")\n    @Authorized()\n    userInfo(@CurrentUser({required:true})user:any)\n    {\n        return user;\n\n    }\n}\n"]}